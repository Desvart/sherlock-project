% Relevé des harmoniques principales pour P01 (T1800)
% h{x,y} : x = erreur
%          y = identifiant mvt (en fonction de l'erreur)

% La différence entre le script V1 et V2 est que la version 2 prend en
% compte des labels pour notifier quelles sont les modes ascendants et
% descendants ainsi que les modes "longs".

clear all;
close all;
clc;

harm{1, 1} =   [50.6, 43.4, 29.3, 28.5, 26.9, 16.8,  0.0; ...
                50.6, 43.4, 29.3,  0.0, 26.9,  0.0, 13.5; ...
                50.6,  0.0, 29.3, 28.5, 26.9, 16.8, 13.5; ...
                50.6, 43.4, 29.3,  0.0, 26.9, 16.8,  0.0; ...
                50.6, 43.4, 29.3, 28.5, 26.9, 16.8,  0.0; ...
                50.6, 43.4,  0.0,  0.0,  0.0,  0.0, 13.5]';
hLegend{1, 1} =[ ' ',  'L',  ' ',  ' ',  ' ',  ' ',  'L'];

harm{1, 2} =   [65.3,  0.0,  0.0,  0.0, 43.4, 42.0, 36.1, 35.5, 26.4, 13.4; ...
                 0.0,  0.0,  0.0, 44.9, 43.4,  0.0,  0.0,  0.0, 26.4, 13.4; ...
                65.3, 48.9, 46.0,  0.0, 43.4, 42.0, 36.1, 35.5,  0.0, 13.4; ...
                 0.0,  0.0,  0.0, 44.9, 43.4,  0.0,  0.0,  0.0, 26.4,  0.0; ...
                65.3, 48.9, 46.0,  0.0, 43.4,  0.0, 36.1, 35.5, 26.4, 13.4; ...
                 0.0,  0.0, 46.0, 44.9, 43.4, 42.0,  0.0,  0.0,  0.0, 13.4]';
hLegend{1, 2} =[ ' ',  ' ',  ' ',  '+',  'L',  ' ',  ' ',  '-',  ' ',  'L'];

harm{1, 3} =   [ 0.0, 77.9, 77.2, 50.2, 47.0,  0.0, 44.7  0.0,  29.5, 17.6, 16.6, 16.0,  0.0; ...
                92.4, 77.9, 77.2, 50.2,  0.0, 46.5,  0.0, 44.1, 29.5,  0.0, 16.6, 16.0, 12.2; ...
                 0.0,  0.0,  0.0,  0.0, 47.0,  0.0, 44.7, 44.1, 29.5, 17.6, 16.6, 16.0,  0.0; ...
                92.4, 77.9, 77.2, 50.2,  0.0, 46.5, 44.7, 44.1, 29.5,  0.0, 16.6, 16.0, 12.2; ...
                 0.0,  0.0, 77.2,  0.0, 47.0,  0.0, 44.7, 44.1, 29.5, 17.6, 16.6, 16.0,  0.0; ...
                92.4, 77.9, 77.2, 50.2,  0.0, 46.5,  0.0, 44.1, 29.5,  0.0, 16.6, 16.0, 12.2]';
hLegend{1, 3} =[ ' ',  ' ',  ' ',  ' ',  '+',  '-',  ' ',  'L',  ' ',  ' ',  ' ',  ' ',  ' '];


harm{2, 1} =   [77.1,  0.0, 51.2, 50.4,  0.0, 48.4,  0.0, 46.7,  0.0, 44.9,  0.0, 42.6, 37.3,  0.0, 24.8,  0.0,  0.0; ...
                77.1, 65.4, 51.2,  0.0, 49.6,  0.0, 47.5,  0.0, 45.9,  0.0, 44.0, 42.6, 37.3, 28.9, 24.8, 23.0,  0.0; ...
                77.1,  0.0, 51.2,  0.0,  0.0, 48.4,  0.0, 46.7,  0.0, 44.9,  0.0, 42.6, 37.3,  0.0, 24.8, 23.0,  0.0; ...
                77.1,  0.0, 51.2,  0.0, 49.6,  0.0, 47.5,  0.0, 45.9,  0.0, 44.0, 42.6, 37.3, 28.9, 24.8, 23.0, 16.0; ...
                77.1,  0.0, 51.2, 50.4,  0.0, 48.4,  0.0, 46.7,  0.0, 44.9,  0.0, 42.6, 37.3,  0.0, 24.8, 23.0, 16.0; ...
                77.1, 65.4, 51.2,  0.0, 49.6,  0.0, 47.5,  0.0, 45.9,  0.0, 44.0, 42.6, 37.3, 28.9, 24.8, 23.0, 16.0]';
hLegend{2, 1} =[ ' ',  ' ',  ' ',  '+',  '-',  '+',  '-',  '+',  '-',  '+',  '-',  'L',  ' ',  ' ',  ' ',  ' ',  ' '];

harm{2, 2} =   [76.2,  0.0, 52.7,  0.0, 51.0,  0.0, 49.2, 49.2, 45.5, 44.3,  0.0, 42.0, 28.9, 25.0, 23.0,  0.0, 17.4, 14.4,  0.0,  0.0; ...
                76.2, 53.9,  0.0, 51.9, 51.0, 50.2, 49.2,  0.0,  0.0, 44.3, 42.6,  0.0, 28.9, 25.0, 23.0, 19.9, 17.4, 14.4, 13.3, 10.3; ...
                76.2,  0.0, 52.7,  0.0, 51.0,  0.0, 49.2, 49.2,  0.0, 44.3,  0.0, 42.0, 28.9,  0.0, 23.0,  0.0, 17.4, 14.4,  0.0,  0.0; ...
                76.2, 53.9,  0.0, 51.9, 51.0, 50.2, 49.2,  0.0,  0.0, 44.3, 42.6,  0.0, 28.9, 25.0, 23.0, 19.9, 17.4, 14.4, 13.3, 10.3; ...
                76.2,  0.0, 52.7,  0.0, 51.0,  0.0, 49.2, 49.2, 45.5, 44.3,  0.0, 42.0,  0.0,  0.0, 23.0,  0.0, 17.4, 14.4,  0.0,  0.0]';
hLegend{2, 2} =[ ' ',  '-',  '+',  '-',  ' ',  '-',  ' ',  '+',  '+',  ' ',  ' ',  '+',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  'L',  ' '];

harm{2, 3} =   [76.0, 71.1, 65.4, 51.8, 51.6, 49.6, 44.3, 42.2, 31.4, 25.0, 23.6; ...
                76.0,  0.0, 65.4, 51.8,  0.0,  0.0, 44.3, 42.2, 31.4, 25.0, 23.6; ...
                76.0, 71.1, 65.4, 51.8, 51.6, 49.6, 44.3, 42.2, 31.4, 25.0, 23.6; ...
                76.0,  0.0,  0.0, 51.8,  0.0,  0.0,  0.0, 42.2, 31.4,  0.0, 23.6; ...
                76.0,  0.0, 65.4, 51.8, 51.6, 49.6, 44.3, 42.2, 31.4, 25.0, 23.6]';
hLegend{2, 3} =[ 'L',  ' ',  ' ',  ' ',  '-',  '-',  ' ',  'L',  ' ',  ' ',  ' '];


harm{3, 1} =   [92.8, 86.7, 84.4, 76.9, 76.2, 50.0, 48.2, 46.7, 43.0,  0.0,  0.0, 29.3, 26.9, 22.5, 16.2, 13.3; ...
                 0.0,  0.0,  0.0,  0.0, 76.2,  0.0,  0.0, 46.7, 43.0,  0.0, 35.2, 29.3, 26.9, 22.5, 16.2, 13.3; ...
                92.8, 86.7, 84.4, 76.9, 76.2, 50.0, 48.2, 46.7, 43.0,  0.0,  0.0, 29.3, 26.9, 22.5, 16.2, 13.3; ...
                 0.0,  0.0,  0.0, 76.9, 76.2,  0.0,  0.0, 46.7, 43.0, 36.9, 35.2, 29.3,  0.0, 22.5, 16.2, 13.3; ...
                92.8, 86.7, 84.4, 76.9, 76.2, 50.0, 48.2, 46.7, 43.0, 36.9,  0.0, 29.3, 26.9, 22.5, 16.2, 13.3; ...
                 0.0,  0.0,  0.0,  0.0, 76.2,  0.0,  0.0, 46.7, 43.0, 36.9, 35.2, 29.3, 26.9, 22.5, 16.2, 13.3]';
hLegend{3, 1} =[ ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  '-',  ' ',  'L',  ' ',  '+',  ' ',  ' ',  ' ',  ' ',  'L'];

harm{3, 2} =   [86.1,  0.0,  0.0, 50.4, 49.8,  0.0, 42.6,  0.0,  0.0, 33.2,  0.0, 23.0, 19.3, 15.8, 13.3, 12.7, 0.0; ...
                86.1, 77.5, 65.8, 50.4,  0.0, 46.7, 42.6, 36.7, 34.0, 33.2, 26.4, 23.0,  0.0, 15.8, 13.3, 12.7, 8.0; ...
                86.1,  0.0,  0.0, 50.4, 49.8, 46.7, 42.6, 36.7,  0.0,  0.0,  0.0, 23.0, 19.3, 15.8, 13.3, 12.7, 8.0; ...
                86.1, 77.5, 65.8, 50.4,  0.0, 46.7, 42.6, 36.7, 34.0, 33.2, 26.4, 23.0, 19.3, 15.8, 13.3, 12.7, 8.0; ...
                86.1,  0.0,  0.0, 50.4, 49.8, 46.7, 42.6,  0.0,  0.0, 33.2,  0.0, 23.0, 19.3, 15.8, 13.3, 12.7, 8.0; ...
                86.1, 77.5, 65.8, 50.4,  0.0, 46.7, 42.6, 36.7, 34.0, 33.2, 26.4, 23.0, 19.3, 15.8, 13.3, 12.7, 8.0]';
hLegend{3, 2} =[ 'L',  ' ',  '-',  ' ',  ' ',  ' ',  'L',  ' ',  '-',  ' ',  '-',  ' ',  ' ',  ' ',  'L',  ' ',  ' '];

harm{3, 3} =   [77.9,  0.0,  0.0,  0.0, 63.4, 50.0, 43.4, 29.3,  0.0,  0.0, 9.4, 0.0; ...
                77.9,  0.0, 66.4, 64.4,  0.0, 50.0, 43.4, 29.3,  0.0, 22.3, 9.4, 4.3; ...
                 0.0, 67.4,  0.0,  0.0, 63.4, 50.0, 43.4, 29.3, 23.5, 22.3, 9.4, 0.0; ...
                77.9,  0.0, 66.4, 64.4,  0.0, 50.0, 43.4, 29.3,  0.0, 22.3, 9.4, 4.3; ...
                77.9, 67.4,  0.0,  0.0,  0.0, 50.0, 43.4, 29.3, 23.5,  0.0, 9.4, 0.0; ...
                77.9,  0.0, 66.4, 64.4,  0.0, 50.0, 43.4, 29.3,  0.0, 22.3, 9.4, 4.3]';
hLegend{3, 3} =[ ' ',  '+',  '-',  '-',  '+',  ' ',  'L',  ' ',  '+',  ' ', ' ', 'L']; 


harm{4, 1} =   [75.6, 55.5,  0.0, 53.5,  0.0, 51.6, 49.8,  0.0, 48.0, 44.3, 42.4, 37.5, 29.1, 25.0, 23.0, 17.4, 16.8, 7.4; ...
                 0.0,  0.0,  0.0,  0.0, 52.5, 51.6,  0.0,  0.0,  0.0, 44.3, 42.4,  0.0, 29.1, 25.0, 23.0, 17.4, 16.8, 7.4; ...
                75.6, 55.5,  0.0, 53.5,  0.0, 51.6, 49.8,  0.0, 48.0, 44.3, 42.4, 37.5, 29.1, 25.0, 23.0, 17.4, 16.8, 7.4; ...
                 0.0,  0.0, 54.5,  0.0, 52.5, 51.6,  0.0, 49.0,  0.0,  0.0, 42.4,  0.0, 29.1, 25.0, 23.0, 17.4,  0.0, 7.4; ...
                75.6, 55.5,  0.0, 53.5,  0.0, 51.6, 49.8,  0.0, 48.0, 44.3, 42.4, 37.5, 29.1, 25.0, 23.0, 17.4, 16.8, 7.4; ...
                 0.0,  0.0, 54.5,  0.0, 52.5, 51.6,  0.0, 49.0,  0.0, 44.3, 42.4, 37.5, 29.1, 25.0, 23.0, 17.4, 16.8, 7.4]';
hLegend{4, 1} =[ 'L',  '-',  '+',  '-',  '+',  ' ',  '-',  '+',  '-',  ' ',  'L',  'L',  ' ',  ' ',  'L',  ' ',  ' ',  ' '];

harm{4, 2} =   [ 0.0,  0.0, 76.9, 76.2, 70.5, 51.8, 46.5,  0.0, 44.5, 42.6; ...
                 0.0, 84.2, 76.9, 76.2, 70.5, 51.8,  0.0, 45.3,  0.0, 42.6; ...
                85.9,  0.0, 76.9, 76.2, 70.5, 51.8, 46.5,  0.0, 44.5,  0.0; ...
                85.9, 84.2, 76.9, 76.2, 70.5, 51.8,  0.0, 45.3,  0.0, 42.6; ...
                85.9, 84.2, 76.9, 76.2, 70.5, 51.8, 46.5,  0.0, 44.5, 42.6; ...
                 0.0, 84.2, 76.9, 76.2, 70.5, 51.8,  0.0, 45.3,  0.0, 42.6]';
hLegend{4, 2} =[ 'L',  ' ',  'L',  ' ',  ' ',  ' ',  '-',  '+',  '-',  'L'];

harm{4, 3} =   [76.6, 65.4, 49.4,  0.0, 29.1, 16.4, 10.2; ...
                 0.0,  0.0, 49.4, 42.4, 29.1, 16.4, 10.2; ...
                76.6, 65.4, 49.4,  0.0, 29.1, 16.4, 10.2; ...
                 0.0,  0.0, 49.4, 42.4, 29.1, 16.4, 10.2; ...
                76.6, 65.4, 49.4,  0.0, 29.1, 16.4, 10.2; ...
                 0.0,  0.0, 49.4, 42.4, 29.1, 16.4, 10.2]';
hLegend{4, 3} =[ ' ',  ' ',  'L',  'L',  ' ',  ' ',  ' '];


figure;
hold on;

for errId = 1 : size(harm, 1),
    for fileId = 1 : size(harm, 2);
        for tocId = 1 : size(harm{errId, fileId}, 2),
            
            tocHarm = harm{errId, fileId}(:, tocId);
            tocLegend = hLegend{errId, fileId};
            for iHarm = 1 : size(harm{errId, fileId}, 1)
                
                if tocHarm(iHarm) > 0,
                    xId = (errId-1)*3 + fileId + 0.1*(tocId-1);
                    switch tocLegend(iHarm),
                        case ' ', colorPlot= 'b';
                                  formPlot = '.';
                        case 'L', colorPlot= 'r';
                                  formPlot = '.';
                        case '+', colorPlot= 'b';
                                  formPlot = '^';
                        case '-', colorPlot= 'b';
                                  formPlot = 'V';
                        
                    end
                    
                    plot(xId, tocHarm(iHarm), [formPlot, colorPlot]);
                end
                
                if tocId >= 4 && tocHarm(iHarm) > 0,
                    if sum(any(harm{errId, fileId} == tocHarm(iHarm))) >= 4,
                        line([(errId-1)*3 + fileId, (errId-1)*3 + fileId + 0.1*(size(harm{errId, fileId}, 2)-1)], [tocHarm(iHarm), tocHarm(iHarm)], 'color', colorPlot);
                    end
                end
                
            end
        end
    end
    
    sepLineIdx = (errId-1)*3 + fileId + 0.1*(size(harm{errId, fileId}, 2) + 2);
    line([sepLineIdx, sepLineIdx], [0, 100], 'color', 'k');
    xlim([0.9, 12.6])
end